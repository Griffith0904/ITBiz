<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mabatis.org//DTD Mapper 3.0//EN"
                       "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="bizDaily">
	<select id="getBizDailyList" parameterType="hashmap" resultType="hashmap">
		SELECT
			A.REC_USER, B.EMPNAME, A.REC_DATE, 
			A.REQ_USER, C.EMPNAME, C.DEPTNAME, A.REQ_SUBJECT, A.REQ_CONTENT, A.ANL_CONTENT, A.WORK_LEV, A.WORK_STATUS, E.BCD_NAME WORK_STATUS_NAME,
			A.BD_SEQ
		FROM
			TB_BIZDAILY_MASTER A WITH(NOLOCK)
			INNER JOIN
				VT_USERALL_LIST B ON A.REC_USER = B.EMPID
			INNER JOIN
				VT_USERALL_LIST C ON A.REQ_USER = C.EMPID AND C.EMPNAME LIKE #{empname}
			LEFT OUTER JOIN
				(SELECT BD_SEQ, COUNT(*) BATCH_CNT FROM TB_BIZDAILY_EXECUTER WITH(NOLOCK) GROUP BY BD_SEQ) D ON A.BD_SEQ = D.BD_SEQ
			INNER JOIN
				(SELECT BCD_CODE, BCD_NAME FROM TB_BASE_DETAIL WITH(NOLOCK) WHERE BCH_CODE = 'W0002') E ON A.WORK_STATUS = E.BCD_CODE
		WHERE
			A.REC_USER LIKE #{rec_user} AND			 
			A.REQ_SUBJECT LIKE #{req_subject} AND
			A.WORK_STATUS LIKE #{work_status} AND
			A.REC_DATE BETWEEN #{rec_sdate} AND #{rec_edate}
		ORDER BY A.REC_DATE, A.BD_SEQ;
	</select>
</mapper>